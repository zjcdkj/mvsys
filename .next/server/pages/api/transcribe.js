"use strict";
/*
 * ATTENTION: An "eval-source-map" devtool has been used.
 * This devtool is neither made for production nor for readable output files.
 * It uses "eval()" calls to create a separate source file with attached SourceMaps in the browser devtools.
 * If you are trying to read the output file, select a different devtool (https://webpack.js.org/configuration/devtool/)
 * or disable the default devtool with "devtool: false".
 * If you are looking for production-ready output files, see mode: "production" (https://webpack.js.org/configuration/mode/).
 */
(() => {
var exports = {};
exports.id = "pages/api/transcribe";
exports.ids = ["pages/api/transcribe"];
exports.modules = {

/***/ "@ffmpeg-installer/ffmpeg":
/*!*******************************************!*\
  !*** external "@ffmpeg-installer/ffmpeg" ***!
  \*******************************************/
/***/ ((module) => {

module.exports = require("@ffmpeg-installer/ffmpeg");

/***/ }),

/***/ "@ffprobe-installer/ffprobe":
/*!*********************************************!*\
  !*** external "@ffprobe-installer/ffprobe" ***!
  \*********************************************/
/***/ ((module) => {

module.exports = require("@ffprobe-installer/ffprobe");

/***/ }),

/***/ "fluent-ffmpeg":
/*!********************************!*\
  !*** external "fluent-ffmpeg" ***!
  \********************************/
/***/ ((module) => {

module.exports = require("fluent-ffmpeg");

/***/ }),

/***/ "mongodb":
/*!**************************!*\
  !*** external "mongodb" ***!
  \**************************/
/***/ ((module) => {

module.exports = require("mongodb");

/***/ }),

/***/ "openai":
/*!*************************!*\
  !*** external "openai" ***!
  \*************************/
/***/ ((module) => {

module.exports = import("openai");;

/***/ }),

/***/ "child_process":
/*!********************************!*\
  !*** external "child_process" ***!
  \********************************/
/***/ ((module) => {

module.exports = require("child_process");

/***/ }),

/***/ "fs":
/*!*********************!*\
  !*** external "fs" ***!
  \*********************/
/***/ ((module) => {

module.exports = require("fs");

/***/ }),

/***/ "path":
/*!***********************!*\
  !*** external "path" ***!
  \***********************/
/***/ ((module) => {

module.exports = require("path");

/***/ }),

/***/ "util":
/*!***********************!*\
  !*** external "util" ***!
  \***********************/
/***/ ((module) => {

module.exports = require("util");

/***/ }),

/***/ "(api)/./pages/api/transcribe.ts":
/*!*********************************!*\
  !*** ./pages/api/transcribe.ts ***!
  \*********************************/
/***/ ((module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.a(module, async (__webpack_handle_async_dependencies__, __webpack_async_result__) => { try {\n__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   \"default\": () => (/* binding */ handler)\n/* harmony export */ });\n/* harmony import */ var _utils_videoProcessor__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../../utils/videoProcessor */ \"(api)/./utils/videoProcessor.ts\");\n/* harmony import */ var _utils_database__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../../utils/database */ \"(api)/./utils/database.ts\");\nvar __webpack_async_dependencies__ = __webpack_handle_async_dependencies__([_utils_videoProcessor__WEBPACK_IMPORTED_MODULE_0__]);\n_utils_videoProcessor__WEBPACK_IMPORTED_MODULE_0__ = (__webpack_async_dependencies__.then ? (await __webpack_async_dependencies__)() : __webpack_async_dependencies__)[0];\n\n\nasync function handler(req, res) {\n    if (req.method === \"POST\") {\n        const { filename } = req.body;\n        if (!filename) {\n            return res.status(400).json({\n                error: \"Filename is required\"\n            });\n        }\n        try {\n            const { db } = await (0,_utils_database__WEBPACK_IMPORTED_MODULE_1__.connectToDatabase)();\n            const collection = db.collection(\"audio_files\");\n            // 更新转录状态为 \"transcribing\"\n            await collection.updateOne({\n                name: filename\n            }, {\n                $set: {\n                    transcriptionStatus: \"transcribing\"\n                }\n            });\n            const transcription = await (0,_utils_videoProcessor__WEBPACK_IMPORTED_MODULE_0__.convertSpeechToText)(filename);\n            // 更新转录状态为 \"transcribed\" 并保存转录文本\n            await collection.updateOne({\n                name: filename\n            }, {\n                $set: {\n                    transcriptionStatus: \"transcribed\",\n                    transcription: transcription\n                }\n            });\n            res.status(200).json({\n                success: true,\n                message: \"Transcription completed successfully\"\n            });\n        } catch (error) {\n            console.error(\"Error in transcription:\", error);\n            res.status(500).json({\n                error: \"Error during transcription process\",\n                details: error.message\n            });\n        }\n    } else {\n        res.setHeader(\"Allow\", [\n            \"POST\"\n        ]);\n        res.status(405).end(`Method ${req.method} Not Allowed`);\n    }\n}\n\n__webpack_async_result__();\n} catch(e) { __webpack_async_result__(e); } });//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKGFwaSkvLi9wYWdlcy9hcGkvdHJhbnNjcmliZS50cyIsIm1hcHBpbmdzIjoiOzs7Ozs7Ozs7QUFDaUU7QUFDUjtBQUUxQyxlQUFlRSxRQUFRQyxHQUFtQixFQUFFQyxHQUFvQjtJQUM3RSxJQUFJRCxJQUFJRSxNQUFNLEtBQUssUUFBUTtRQUN6QixNQUFNLEVBQUVDLFFBQVEsRUFBRSxHQUFHSCxJQUFJSSxJQUFJO1FBRTdCLElBQUksQ0FBQ0QsVUFBVTtZQUNiLE9BQU9GLElBQUlJLE1BQU0sQ0FBQyxLQUFLQyxJQUFJLENBQUM7Z0JBQUVDLE9BQU87WUFBdUI7UUFDOUQ7UUFFQSxJQUFJO1lBQ0YsTUFBTSxFQUFFQyxFQUFFLEVBQUUsR0FBRyxNQUFNVixrRUFBaUJBO1lBQ3RDLE1BQU1XLGFBQWFELEdBQUdDLFVBQVUsQ0FBQztZQUVqQyx5QkFBeUI7WUFDekIsTUFBTUEsV0FBV0MsU0FBUyxDQUFDO2dCQUFFQyxNQUFNUjtZQUFTLEdBQUc7Z0JBQUVTLE1BQU07b0JBQUVDLHFCQUFxQjtnQkFBZTtZQUFFO1lBRS9GLE1BQU1DLGdCQUFnQixNQUFNakIsMEVBQW1CQSxDQUFDTTtZQUVoRCxnQ0FBZ0M7WUFDaEMsTUFBTU0sV0FBV0MsU0FBUyxDQUN4QjtnQkFBRUMsTUFBTVI7WUFBUyxHQUNqQjtnQkFBRVMsTUFBTTtvQkFBRUMscUJBQXFCO29CQUFlQyxlQUFlQTtnQkFBYztZQUFFO1lBRy9FYixJQUFJSSxNQUFNLENBQUMsS0FBS0MsSUFBSSxDQUFDO2dCQUFFUyxTQUFTO2dCQUFNQyxTQUFTO1lBQXVDO1FBQ3hGLEVBQUUsT0FBT1QsT0FBTztZQUNkVSxRQUFRVixLQUFLLENBQUMsMkJBQTJCQTtZQUN6Q04sSUFBSUksTUFBTSxDQUFDLEtBQUtDLElBQUksQ0FBQztnQkFBRUMsT0FBTztnQkFBc0NXLFNBQVNYLE1BQU1TLE9BQU87WUFBQztRQUM3RjtJQUNGLE9BQU87UUFDTGYsSUFBSWtCLFNBQVMsQ0FBQyxTQUFTO1lBQUM7U0FBTztRQUMvQmxCLElBQUlJLE1BQU0sQ0FBQyxLQUFLZSxHQUFHLENBQUMsQ0FBQyxPQUFPLEVBQUVwQixJQUFJRSxNQUFNLENBQUMsWUFBWSxDQUFDO0lBQ3hEO0FBQ0YiLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly92aWRlby1hbmFseXNpcy1zeXN0ZW0vLi9wYWdlcy9hcGkvdHJhbnNjcmliZS50cz81MmUyIl0sInNvdXJjZXNDb250ZW50IjpbImltcG9ydCB7IE5leHRBcGlSZXF1ZXN0LCBOZXh0QXBpUmVzcG9uc2UgfSBmcm9tICduZXh0JztcbmltcG9ydCB7IGNvbnZlcnRTcGVlY2hUb1RleHQgfSBmcm9tICcuLi8uLi91dGlscy92aWRlb1Byb2Nlc3Nvcic7XG5pbXBvcnQgeyBjb25uZWN0VG9EYXRhYmFzZSB9IGZyb20gJy4uLy4uL3V0aWxzL2RhdGFiYXNlJztcblxuZXhwb3J0IGRlZmF1bHQgYXN5bmMgZnVuY3Rpb24gaGFuZGxlcihyZXE6IE5leHRBcGlSZXF1ZXN0LCByZXM6IE5leHRBcGlSZXNwb25zZSkge1xuICBpZiAocmVxLm1ldGhvZCA9PT0gJ1BPU1QnKSB7XG4gICAgY29uc3QgeyBmaWxlbmFtZSB9ID0gcmVxLmJvZHk7XG5cbiAgICBpZiAoIWZpbGVuYW1lKSB7XG4gICAgICByZXR1cm4gcmVzLnN0YXR1cyg0MDApLmpzb24oeyBlcnJvcjogJ0ZpbGVuYW1lIGlzIHJlcXVpcmVkJyB9KTtcbiAgICB9XG5cbiAgICB0cnkge1xuICAgICAgY29uc3QgeyBkYiB9ID0gYXdhaXQgY29ubmVjdFRvRGF0YWJhc2UoKTtcbiAgICAgIGNvbnN0IGNvbGxlY3Rpb24gPSBkYi5jb2xsZWN0aW9uKCdhdWRpb19maWxlcycpO1xuXG4gICAgICAvLyDmm7TmlrDovazlvZXnirbmgIHkuLogXCJ0cmFuc2NyaWJpbmdcIlxuICAgICAgYXdhaXQgY29sbGVjdGlvbi51cGRhdGVPbmUoeyBuYW1lOiBmaWxlbmFtZSB9LCB7ICRzZXQ6IHsgdHJhbnNjcmlwdGlvblN0YXR1czogJ3RyYW5zY3JpYmluZycgfSB9KTtcblxuICAgICAgY29uc3QgdHJhbnNjcmlwdGlvbiA9IGF3YWl0IGNvbnZlcnRTcGVlY2hUb1RleHQoZmlsZW5hbWUpO1xuXG4gICAgICAvLyDmm7TmlrDovazlvZXnirbmgIHkuLogXCJ0cmFuc2NyaWJlZFwiIOW5tuS/neWtmOi9rOW9leaWh+acrFxuICAgICAgYXdhaXQgY29sbGVjdGlvbi51cGRhdGVPbmUoXG4gICAgICAgIHsgbmFtZTogZmlsZW5hbWUgfSxcbiAgICAgICAgeyAkc2V0OiB7IHRyYW5zY3JpcHRpb25TdGF0dXM6ICd0cmFuc2NyaWJlZCcsIHRyYW5zY3JpcHRpb246IHRyYW5zY3JpcHRpb24gfSB9XG4gICAgICApO1xuXG4gICAgICByZXMuc3RhdHVzKDIwMCkuanNvbih7IHN1Y2Nlc3M6IHRydWUsIG1lc3NhZ2U6ICdUcmFuc2NyaXB0aW9uIGNvbXBsZXRlZCBzdWNjZXNzZnVsbHknIH0pO1xuICAgIH0gY2F0Y2ggKGVycm9yKSB7XG4gICAgICBjb25zb2xlLmVycm9yKCdFcnJvciBpbiB0cmFuc2NyaXB0aW9uOicsIGVycm9yKTtcbiAgICAgIHJlcy5zdGF0dXMoNTAwKS5qc29uKHsgZXJyb3I6ICdFcnJvciBkdXJpbmcgdHJhbnNjcmlwdGlvbiBwcm9jZXNzJywgZGV0YWlsczogZXJyb3IubWVzc2FnZSB9KTtcbiAgICB9XG4gIH0gZWxzZSB7XG4gICAgcmVzLnNldEhlYWRlcignQWxsb3cnLCBbJ1BPU1QnXSk7XG4gICAgcmVzLnN0YXR1cyg0MDUpLmVuZChgTWV0aG9kICR7cmVxLm1ldGhvZH0gTm90IEFsbG93ZWRgKTtcbiAgfVxufVxuIl0sIm5hbWVzIjpbImNvbnZlcnRTcGVlY2hUb1RleHQiLCJjb25uZWN0VG9EYXRhYmFzZSIsImhhbmRsZXIiLCJyZXEiLCJyZXMiLCJtZXRob2QiLCJmaWxlbmFtZSIsImJvZHkiLCJzdGF0dXMiLCJqc29uIiwiZXJyb3IiLCJkYiIsImNvbGxlY3Rpb24iLCJ1cGRhdGVPbmUiLCJuYW1lIiwiJHNldCIsInRyYW5zY3JpcHRpb25TdGF0dXMiLCJ0cmFuc2NyaXB0aW9uIiwic3VjY2VzcyIsIm1lc3NhZ2UiLCJjb25zb2xlIiwiZGV0YWlscyIsInNldEhlYWRlciIsImVuZCJdLCJzb3VyY2VSb290IjoiIn0=\n//# sourceURL=webpack-internal:///(api)/./pages/api/transcribe.ts\n");

/***/ }),

/***/ "(api)/./utils/database.ts":
/*!***************************!*\
  !*** ./utils/database.ts ***!
  \***************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   connectToDatabase: () => (/* binding */ connectToDatabase)\n/* harmony export */ });\n/* harmony import */ var mongodb__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! mongodb */ \"mongodb\");\n/* harmony import */ var mongodb__WEBPACK_IMPORTED_MODULE_0___default = /*#__PURE__*/__webpack_require__.n(mongodb__WEBPACK_IMPORTED_MODULE_0__);\n\nconst MONGODB_URI = process.env.MONGODB_URI;\nif (!MONGODB_URI) {\n    throw new Error(\"Please define the MONGODB_URI environment variable inside .env.local\");\n}\nlet cached = global;\nif (!cached.mongo) {\n    cached.mongo = {\n        conn: null,\n        promise: null\n    };\n}\nasync function connectToDatabase() {\n    if (cached.mongo.conn) {\n        return cached.mongo.conn;\n    }\n    if (!cached.mongo.promise) {\n        const opts = {\n            useNewUrlParser: true,\n            useUnifiedTopology: true\n        };\n        cached.mongo.promise = mongodb__WEBPACK_IMPORTED_MODULE_0__.MongoClient.connect(MONGODB_URI, opts).then((client)=>{\n            console.log(\"New database connection established\");\n            return {\n                client,\n                db: client.db()\n            };\n        }).catch((error)=>{\n            console.error(\"Failed to connect to database:\", error);\n            throw error;\n        });\n    }\n    try {\n        cached.mongo.conn = await cached.mongo.promise;\n    } catch (e) {\n        cached.mongo.promise = null;\n        throw e;\n    }\n    return cached.mongo.conn;\n}\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKGFwaSkvLi91dGlscy9kYXRhYmFzZS50cyIsIm1hcHBpbmdzIjoiOzs7Ozs7QUFBc0M7QUFFdEMsTUFBTUMsY0FBY0MsUUFBUUMsR0FBRyxDQUFDRixXQUFXO0FBRTNDLElBQUksQ0FBQ0EsYUFBYTtJQUNoQixNQUFNLElBQUlHLE1BQU07QUFDbEI7QUFFQSxJQUFJQyxTQUFTQztBQUViLElBQUksQ0FBQ0QsT0FBT0UsS0FBSyxFQUFFO0lBQ2pCRixPQUFPRSxLQUFLLEdBQUc7UUFBRUMsTUFBTTtRQUFNQyxTQUFTO0lBQUs7QUFDN0M7QUFFTyxlQUFlQztJQUNwQixJQUFJTCxPQUFPRSxLQUFLLENBQUNDLElBQUksRUFBRTtRQUNyQixPQUFPSCxPQUFPRSxLQUFLLENBQUNDLElBQUk7SUFDMUI7SUFFQSxJQUFJLENBQUNILE9BQU9FLEtBQUssQ0FBQ0UsT0FBTyxFQUFFO1FBQ3pCLE1BQU1FLE9BQU87WUFDWEMsaUJBQWlCO1lBQ2pCQyxvQkFBb0I7UUFDdEI7UUFFQVIsT0FBT0UsS0FBSyxDQUFDRSxPQUFPLEdBQUdULGdEQUFXQSxDQUFDYyxPQUFPLENBQUNiLGFBQWNVLE1BQU1JLElBQUksQ0FBQyxDQUFDQztZQUNuRUMsUUFBUUMsR0FBRyxDQUFDO1lBQ1osT0FBTztnQkFDTEY7Z0JBQ0FHLElBQUlILE9BQU9HLEVBQUU7WUFDZjtRQUNGLEdBQUdDLEtBQUssQ0FBQyxDQUFDQztZQUNSSixRQUFRSSxLQUFLLENBQUMsa0NBQWtDQTtZQUNoRCxNQUFNQTtRQUNSO0lBQ0Y7SUFFQSxJQUFJO1FBQ0ZoQixPQUFPRSxLQUFLLENBQUNDLElBQUksR0FBRyxNQUFNSCxPQUFPRSxLQUFLLENBQUNFLE9BQU87SUFDaEQsRUFBRSxPQUFPYSxHQUFHO1FBQ1ZqQixPQUFPRSxLQUFLLENBQUNFLE9BQU8sR0FBRztRQUN2QixNQUFNYTtJQUNSO0lBRUEsT0FBT2pCLE9BQU9FLEtBQUssQ0FBQ0MsSUFBSTtBQUMxQiIsInNvdXJjZXMiOlsid2VicGFjazovL3ZpZGVvLWFuYWx5c2lzLXN5c3RlbS8uL3V0aWxzL2RhdGFiYXNlLnRzPzZhZjkiXSwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IHsgTW9uZ29DbGllbnQgfSBmcm9tICdtb25nb2RiJztcblxuY29uc3QgTU9OR09EQl9VUkkgPSBwcm9jZXNzLmVudi5NT05HT0RCX1VSSTtcblxuaWYgKCFNT05HT0RCX1VSSSkge1xuICB0aHJvdyBuZXcgRXJyb3IoJ1BsZWFzZSBkZWZpbmUgdGhlIE1PTkdPREJfVVJJIGVudmlyb25tZW50IHZhcmlhYmxlIGluc2lkZSAuZW52LmxvY2FsJyk7XG59XG5cbmxldCBjYWNoZWQgPSBnbG9iYWwgYXMgYW55O1xuXG5pZiAoIWNhY2hlZC5tb25nbykge1xuICBjYWNoZWQubW9uZ28gPSB7IGNvbm46IG51bGwsIHByb21pc2U6IG51bGwgfTtcbn1cblxuZXhwb3J0IGFzeW5jIGZ1bmN0aW9uIGNvbm5lY3RUb0RhdGFiYXNlKCkge1xuICBpZiAoY2FjaGVkLm1vbmdvLmNvbm4pIHtcbiAgICByZXR1cm4gY2FjaGVkLm1vbmdvLmNvbm47XG4gIH1cblxuICBpZiAoIWNhY2hlZC5tb25nby5wcm9taXNlKSB7XG4gICAgY29uc3Qgb3B0cyA9IHtcbiAgICAgIHVzZU5ld1VybFBhcnNlcjogdHJ1ZSxcbiAgICAgIHVzZVVuaWZpZWRUb3BvbG9neTogdHJ1ZSxcbiAgICB9O1xuXG4gICAgY2FjaGVkLm1vbmdvLnByb21pc2UgPSBNb25nb0NsaWVudC5jb25uZWN0KE1PTkdPREJfVVJJISwgb3B0cykudGhlbigoY2xpZW50KSA9PiB7XG4gICAgICBjb25zb2xlLmxvZygnTmV3IGRhdGFiYXNlIGNvbm5lY3Rpb24gZXN0YWJsaXNoZWQnKTtcbiAgICAgIHJldHVybiB7XG4gICAgICAgIGNsaWVudCxcbiAgICAgICAgZGI6IGNsaWVudC5kYigpLFxuICAgICAgfTtcbiAgICB9KS5jYXRjaCgoZXJyb3IpID0+IHtcbiAgICAgIGNvbnNvbGUuZXJyb3IoJ0ZhaWxlZCB0byBjb25uZWN0IHRvIGRhdGFiYXNlOicsIGVycm9yKTtcbiAgICAgIHRocm93IGVycm9yO1xuICAgIH0pO1xuICB9XG5cbiAgdHJ5IHtcbiAgICBjYWNoZWQubW9uZ28uY29ubiA9IGF3YWl0IGNhY2hlZC5tb25nby5wcm9taXNlO1xuICB9IGNhdGNoIChlKSB7XG4gICAgY2FjaGVkLm1vbmdvLnByb21pc2UgPSBudWxsO1xuICAgIHRocm93IGU7XG4gIH1cblxuICByZXR1cm4gY2FjaGVkLm1vbmdvLmNvbm47XG59XG4iXSwibmFtZXMiOlsiTW9uZ29DbGllbnQiLCJNT05HT0RCX1VSSSIsInByb2Nlc3MiLCJlbnYiLCJFcnJvciIsImNhY2hlZCIsImdsb2JhbCIsIm1vbmdvIiwiY29ubiIsInByb21pc2UiLCJjb25uZWN0VG9EYXRhYmFzZSIsIm9wdHMiLCJ1c2VOZXdVcmxQYXJzZXIiLCJ1c2VVbmlmaWVkVG9wb2xvZ3kiLCJjb25uZWN0IiwidGhlbiIsImNsaWVudCIsImNvbnNvbGUiLCJsb2ciLCJkYiIsImNhdGNoIiwiZXJyb3IiLCJlIl0sInNvdXJjZVJvb3QiOiIifQ==\n//# sourceURL=webpack-internal:///(api)/./utils/database.ts\n");

/***/ }),

/***/ "(api)/./utils/videoProcessor.ts":
/*!*********************************!*\
  !*** ./utils/videoProcessor.ts ***!
  \*********************************/
/***/ ((module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.a(module, async (__webpack_handle_async_dependencies__, __webpack_async_result__) => { try {\n__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   checkFFmpeg: () => (/* binding */ checkFFmpeg),\n/* harmony export */   cleanText: () => (/* binding */ cleanText),\n/* harmony export */   convertSpeechToText: () => (/* binding */ convertSpeechToText),\n/* harmony export */   extractAudio: () => (/* binding */ extractAudio),\n/* harmony export */   getAudioDuration: () => (/* binding */ getAudioDuration),\n/* harmony export */   getAudioFileUrl: () => (/* binding */ getAudioFileUrl),\n/* harmony export */   getFFmpegVersion: () => (/* binding */ getFFmpegVersion),\n/* harmony export */   processVideo: () => (/* binding */ processVideo)\n/* harmony export */ });\n/* harmony import */ var child_process__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! child_process */ \"child_process\");\n/* harmony import */ var child_process__WEBPACK_IMPORTED_MODULE_0___default = /*#__PURE__*/__webpack_require__.n(child_process__WEBPACK_IMPORTED_MODULE_0__);\n/* harmony import */ var fs__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! fs */ \"fs\");\n/* harmony import */ var fs__WEBPACK_IMPORTED_MODULE_1___default = /*#__PURE__*/__webpack_require__.n(fs__WEBPACK_IMPORTED_MODULE_1__);\n/* harmony import */ var path__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! path */ \"path\");\n/* harmony import */ var path__WEBPACK_IMPORTED_MODULE_2___default = /*#__PURE__*/__webpack_require__.n(path__WEBPACK_IMPORTED_MODULE_2__);\n/* harmony import */ var openai__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! openai */ \"openai\");\n/* harmony import */ var mongodb__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! mongodb */ \"mongodb\");\n/* harmony import */ var mongodb__WEBPACK_IMPORTED_MODULE_4___default = /*#__PURE__*/__webpack_require__.n(mongodb__WEBPACK_IMPORTED_MODULE_4__);\n/* harmony import */ var fluent_ffmpeg__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! fluent-ffmpeg */ \"fluent-ffmpeg\");\n/* harmony import */ var fluent_ffmpeg__WEBPACK_IMPORTED_MODULE_5___default = /*#__PURE__*/__webpack_require__.n(fluent_ffmpeg__WEBPACK_IMPORTED_MODULE_5__);\n/* harmony import */ var _ffmpeg_installer_ffmpeg__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(/*! @ffmpeg-installer/ffmpeg */ \"@ffmpeg-installer/ffmpeg\");\n/* harmony import */ var _ffmpeg_installer_ffmpeg__WEBPACK_IMPORTED_MODULE_6___default = /*#__PURE__*/__webpack_require__.n(_ffmpeg_installer_ffmpeg__WEBPACK_IMPORTED_MODULE_6__);\n/* harmony import */ var _ffprobe_installer_ffprobe__WEBPACK_IMPORTED_MODULE_7__ = __webpack_require__(/*! @ffprobe-installer/ffprobe */ \"@ffprobe-installer/ffprobe\");\n/* harmony import */ var _ffprobe_installer_ffprobe__WEBPACK_IMPORTED_MODULE_7___default = /*#__PURE__*/__webpack_require__.n(_ffprobe_installer_ffprobe__WEBPACK_IMPORTED_MODULE_7__);\n/* harmony import */ var util__WEBPACK_IMPORTED_MODULE_8__ = __webpack_require__(/*! util */ \"util\");\n/* harmony import */ var util__WEBPACK_IMPORTED_MODULE_8___default = /*#__PURE__*/__webpack_require__.n(util__WEBPACK_IMPORTED_MODULE_8__);\n/* harmony import */ var _database__WEBPACK_IMPORTED_MODULE_9__ = __webpack_require__(/*! ./database */ \"(api)/./utils/database.ts\");\nvar __webpack_async_dependencies__ = __webpack_handle_async_dependencies__([openai__WEBPACK_IMPORTED_MODULE_3__]);\nopenai__WEBPACK_IMPORTED_MODULE_3__ = (__webpack_async_dependencies__.then ? (await __webpack_async_dependencies__)() : __webpack_async_dependencies__)[0];\n\n\n\n\n\n\n\n\n\n\n\nconst openai = new openai__WEBPACK_IMPORTED_MODULE_3__[\"default\"]({\n    apiKey: process.env.OPENAI_API_KEY,\n    baseURL: \"https://api.openai-hub.com/v1\"\n});\nconst mongoUri = process.env.MONGODB_URI;\nif (!mongoUri) {\n    console.error(\"MONGODB_URI is not defined in the environment variables\");\n    process.exit(1);\n}\nconsole.log(\"MongoDB URI:\", mongoUri);\nlet mongoClient = null;\nasync function getMongoClient() {\n    if (!mongoUri) {\n        throw new Error(\"MONGODB_URI is not defined\");\n    }\n    if (!mongoClient) {\n        try {\n            mongoClient = new mongodb__WEBPACK_IMPORTED_MODULE_4__.MongoClient(mongoUri);\n            await mongoClient.connect();\n            console.log(\"Connected successfully to MongoDB\");\n        } catch (error) {\n            console.error(\"Failed to connect to MongoDB:\", error);\n            throw error;\n        }\n    }\n    return mongoClient;\n}\nfunction runCommand(command) {\n    return new Promise((resolve, reject)=>{\n        (0,child_process__WEBPACK_IMPORTED_MODULE_0__.exec)(command, {\n            encoding: \"utf8\"\n        }, (error, stdout, stderr)=>{\n            if (error) {\n                console.error(`Error executing command: ${command}`);\n                console.error(`Error: ${error}`);\n                console.error(`stderr: ${stderr}`);\n                reject(error);\n            } else {\n                resolve(stdout);\n            }\n        });\n    });\n}\nasync function processVideo(filePath) {\n    try {\n        // 1. 音频分离\n        const audioFile = await extractAudio(filePath);\n        // 2. 音频转文本\n        const textContent = await convertSpeechToText(audioFile);\n        // 3. 文本清洗\n        const cleanedText = await cleanText(textContent);\n        // 4. 文本存储\n        await storeText([\n            cleanedText\n        ]);\n        // 5. 高级分析\n        const analysisResult = await performAdvancedAnalysis([\n            cleanedText\n        ]);\n        return analysisResult;\n    } catch (error) {\n        console.error(\"Error in video processing:\", error);\n        throw error;\n    }\n}\nfunction extractAudio(videoPath) {\n    return new Promise((resolve, reject)=>{\n        const outputDir = path__WEBPACK_IMPORTED_MODULE_2___default().join(process.cwd(), \"public\", \"audio\");\n        if (!fs__WEBPACK_IMPORTED_MODULE_1___default().existsSync(outputDir)) {\n            fs__WEBPACK_IMPORTED_MODULE_1___default().mkdirSync(outputDir, {\n                recursive: true\n            });\n        }\n        const outputPath = path__WEBPACK_IMPORTED_MODULE_2___default().join(outputDir, `${path__WEBPACK_IMPORTED_MODULE_2___default().basename(videoPath, \".mp4\")}.mp3`);\n        console.log(\"Input video path:\", videoPath);\n        console.log(\"Output audio path:\", outputPath);\n        fluent_ffmpeg__WEBPACK_IMPORTED_MODULE_5___default()(videoPath).outputOptions(\"-vn\").audioCodec(\"libmp3lame\").audioChannels(2).audioBitrate(\"192k\").output(outputPath).on(\"end\", async ()=>{\n            console.log(\"Audio extraction completed:\", outputPath);\n            try {\n                const { db } = await (0,_database__WEBPACK_IMPORTED_MODULE_9__.connectToDatabase)();\n                const collection = db.collection(\"audio_files\");\n                const duration = await getAudioDuration(outputPath);\n                await collection.insertOne({\n                    name: path__WEBPACK_IMPORTED_MODULE_2___default().basename(outputPath),\n                    size: fs__WEBPACK_IMPORTED_MODULE_1___default().statSync(outputPath).size,\n                    createdAt: new Date(),\n                    path: outputPath,\n                    originalVideo: path__WEBPACK_IMPORTED_MODULE_2___default().basename(videoPath),\n                    duration: duration,\n                    transcriptionStatus: \"not_transcribed\"\n                });\n                resolve(outputPath);\n            } catch (error) {\n                console.error(\"Error saving audio file info to database:\", error);\n                reject(error);\n            }\n        }).on(\"error\", (err)=>{\n            console.error(\"Error during audio extraction:\", err);\n            reject(err);\n        }).run();\n    });\n}\nasync function convertSpeechToText(audioFile) {\n    try {\n        const audioPath = path__WEBPACK_IMPORTED_MODULE_2___default().join(process.cwd(), \"public\", \"audio\", audioFile);\n        if (!fs__WEBPACK_IMPORTED_MODULE_1___default().existsSync(audioPath)) {\n            throw new Error(`Audio file not found: ${audioPath}`);\n        }\n        const response = await openai.audio.transcriptions.create({\n            file: fs__WEBPACK_IMPORTED_MODULE_1___default().createReadStream(audioPath),\n            model: \"whisper-1\"\n        });\n        const transcription = response.text;\n        // 保存转录文本为 txt 文件\n        const txtFilePath = audioPath.replace(\".mp3\", \".txt\");\n        await fs__WEBPACK_IMPORTED_MODULE_1__.promises.writeFile(txtFilePath, transcription, \"utf-8\");\n        console.log(\"Transcription saved to:\", txtFilePath);\n        return transcription;\n    } catch (error) {\n        console.error(\"Error in speech to text conversion:\", error);\n        throw error;\n    }\n}\nasync function cleanText(text) {\n    // 这里可以实现文本清洗的逻辑\n    // 例如：移除特殊字符，纠正常见错误等\n    let cleanedText = text.replace(/[^\\w\\s.,?!]/g, \"\");\n    cleanedText = cleanedText.replace(/\\s+/g, \" \").trim();\n    return cleanedText;\n}\nasync function storeText(texts) {\n    const client = await getMongoClient();\n    try {\n        const db = client.db(\"video_analysis\");\n        const collection = db.collection(\"transcripts\");\n        await collection.insertMany(texts.map((text)=>({\n                content: text\n            })));\n        console.log(\"Texts stored successfully in MongoDB\");\n    } catch (error) {\n        console.error(\"Error storing texts in MongoDB:\", error);\n        throw error;\n    }\n}\nasync function performAdvancedAnalysis(texts) {\n    return {\n        analysis: \"Sample analysis result\"\n    };\n}\nasync function getAudioDuration(filePath) {\n    return new Promise((resolve, reject)=>{\n        fluent_ffmpeg__WEBPACK_IMPORTED_MODULE_5___default().ffprobe(filePath, (err, metadata)=>{\n            if (err) {\n                reject(err);\n                return;\n            }\n            const durationInSeconds = metadata.format.duration;\n            resolve(durationInSeconds);\n        });\n    });\n}\nasync function checkFFmpeg() {\n    try {\n        const getAvailableFormats = (0,util__WEBPACK_IMPORTED_MODULE_8__.promisify)((fluent_ffmpeg__WEBPACK_IMPORTED_MODULE_5___default().getAvailableFormats));\n        await getAvailableFormats();\n        console.log(\"FFmpeg is available\");\n        return true;\n    } catch (error) {\n        console.error(\"Error checking FFmpeg:\", error);\n        return false;\n    }\n}\nasync function getFFmpegVersion() {\n    try {\n        const getAvailableCodecs = (0,util__WEBPACK_IMPORTED_MODULE_8__.promisify)((fluent_ffmpeg__WEBPACK_IMPORTED_MODULE_5___default().getAvailableCodecs));\n        const getAvailableEncoders = (0,util__WEBPACK_IMPORTED_MODULE_8__.promisify)((fluent_ffmpeg__WEBPACK_IMPORTED_MODULE_5___default().getAvailableEncoders));\n        const codecs = await getAvailableCodecs();\n        const encoders = await getAvailableEncoders();\n        return `FFmpeg version: available (codecs: ${Object.keys(codecs).length}, encoders: ${Object.keys(encoders).length})`;\n    } catch (error) {\n        console.error(\"Error getting FFmpeg version:\", error);\n        return \"FFmpeg version: unavailable\";\n    }\n}\nfluent_ffmpeg__WEBPACK_IMPORTED_MODULE_5___default().setFfmpegPath((_ffmpeg_installer_ffmpeg__WEBPACK_IMPORTED_MODULE_6___default().path));\nfluent_ffmpeg__WEBPACK_IMPORTED_MODULE_5___default().setFfprobePath((_ffprobe_installer_ffprobe__WEBPACK_IMPORTED_MODULE_7___default().path));\nasync function getAudioFileUrl(filename) {\n    // 检查多个可能的路径\n    const possiblePaths = [\n        path__WEBPACK_IMPORTED_MODULE_2___default().join(process.cwd(), \"download\", \"mp3\", filename),\n        path__WEBPACK_IMPORTED_MODULE_2___default().join(process.cwd(), \"public\", \"audio\", filename),\n        path__WEBPACK_IMPORTED_MODULE_2___default().join(process.cwd(), \"public\", \"uploads\", filename)\n    ];\n    for (const filePath of possiblePaths){\n        console.log(\"Checking for audio file at:\", filePath);\n        if (fs__WEBPACK_IMPORTED_MODULE_1___default().existsSync(filePath)) {\n            console.log(\"Audio file found at:\", filePath);\n            // 返回相对于公共目录的路径\n            return `/audio/${encodeURIComponent(filename)}`;\n        }\n    }\n    console.error(\"Audio file not found:\", filename);\n    console.error(\"Checked paths:\", possiblePaths);\n    throw new Error(`Audio file not found: ${filename}`);\n}\n\n__webpack_async_result__();\n} catch(e) { __webpack_async_result__(e); } });//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,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QUFDb0MsV0FBVztZQUMzQmpCLFFBQVFHLEdBQUcsQ0FBQyx3QkFBd0JjO1lBQ3BDLGVBQWU7WUFDZixPQUFPLENBQUMsT0FBTyxFQUFFOEUsbUJBQW1CRixVQUFVLENBQUM7UUFDakQ7SUFDRjtJQUVBN0YsUUFBUUMsS0FBSyxDQUFDLHlCQUF5QjRGO0lBQ3ZDN0YsUUFBUUMsS0FBSyxDQUFDLGtCQUFrQjZGO0lBQ2hDLE1BQU0sSUFBSXhGLE1BQU0sQ0FBQyxzQkFBc0IsRUFBRXVGLFNBQVMsQ0FBQztBQUNyRCIsInNvdXJjZXMiOlsid2VicGFjazovL3ZpZGVvLWFuYWx5c2lzLXN5c3RlbS8uL3V0aWxzL3ZpZGVvUHJvY2Vzc29yLnRzP2RiOWQiXSwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IHsgZXhlYyB9IGZyb20gJ2NoaWxkX3Byb2Nlc3MnO1xuaW1wb3J0IGZzIGZyb20gJ2ZzJztcbmltcG9ydCBwYXRoIGZyb20gJ3BhdGgnO1xuaW1wb3J0IE9wZW5BSSBmcm9tICdvcGVuYWknO1xuaW1wb3J0IHsgTW9uZ29DbGllbnQgfSBmcm9tICdtb25nb2RiJztcbmltcG9ydCBmZm1wZWcgZnJvbSAnZmx1ZW50LWZmbXBlZyc7XG5pbXBvcnQgZmZtcGVnSW5zdGFsbGVyIGZyb20gJ0BmZm1wZWctaW5zdGFsbGVyL2ZmbXBlZyc7XG5pbXBvcnQgZmZwcm9iZUluc3RhbGxlciBmcm9tICdAZmZwcm9iZS1pbnN0YWxsZXIvZmZwcm9iZSc7XG5pbXBvcnQgeyBwcm9taXNpZnkgfSBmcm9tICd1dGlsJztcbmltcG9ydCB7IHByb21pc2VzIGFzIGZzUHJvbWlzZXMgfSBmcm9tICdmcyc7XG5pbXBvcnQgeyBjb25uZWN0VG9EYXRhYmFzZSB9IGZyb20gJy4vZGF0YWJhc2UnO1xuXG5jb25zdCBvcGVuYWkgPSBuZXcgT3BlbkFJKHtcbiAgYXBpS2V5OiBwcm9jZXNzLmVudi5PUEVOQUlfQVBJX0tFWSxcbiAgYmFzZVVSTDogJ2h0dHBzOi8vYXBpLm9wZW5haS1odWIuY29tL3YxJywgLy8g5L2/55So5oKo5o+Q5L6b55qE6Ieq5a6a5LmJIFVSTFxufSk7XG5cbmNvbnN0IG1vbmdvVXJpID0gcHJvY2Vzcy5lbnYuTU9OR09EQl9VUkk7XG5pZiAoIW1vbmdvVXJpKSB7XG4gIGNvbnNvbGUuZXJyb3IoJ01PTkdPREJfVVJJIGlzIG5vdCBkZWZpbmVkIGluIHRoZSBlbnZpcm9ubWVudCB2YXJpYWJsZXMnKTtcbiAgcHJvY2Vzcy5leGl0KDEpO1xufVxuXG5jb25zb2xlLmxvZygnTW9uZ29EQiBVUkk6JywgbW9uZ29VcmkpO1xuXG5sZXQgbW9uZ29DbGllbnQ6IE1vbmdvQ2xpZW50IHwgbnVsbCA9IG51bGw7XG5cbmFzeW5jIGZ1bmN0aW9uIGdldE1vbmdvQ2xpZW50KCkge1xuICBpZiAoIW1vbmdvVXJpKSB7XG4gICAgdGhyb3cgbmV3IEVycm9yKCdNT05HT0RCX1VSSSBpcyBub3QgZGVmaW5lZCcpO1xuICB9XG4gIGlmICghbW9uZ29DbGllbnQpIHtcbiAgICB0cnkge1xuICAgICAgbW9uZ29DbGllbnQgPSBuZXcgTW9uZ29DbGllbnQobW9uZ29VcmkpO1xuICAgICAgYXdhaXQgbW9uZ29DbGllbnQuY29ubmVjdCgpO1xuICAgICAgY29uc29sZS5sb2coJ0Nvbm5lY3RlZCBzdWNjZXNzZnVsbHkgdG8gTW9uZ29EQicpO1xuICAgIH0gY2F0Y2ggKGVycm9yKSB7XG4gICAgICBjb25zb2xlLmVycm9yKCdGYWlsZWQgdG8gY29ubmVjdCB0byBNb25nb0RCOicsIGVycm9yKTtcbiAgICAgIHRocm93IGVycm9yO1xuICAgIH1cbiAgfVxuICByZXR1cm4gbW9uZ29DbGllbnQ7XG59XG5cbmZ1bmN0aW9uIHJ1bkNvbW1hbmQoY29tbWFuZDogc3RyaW5nKTogUHJvbWlzZTxzdHJpbmc+IHtcbiAgcmV0dXJuIG5ldyBQcm9taXNlKChyZXNvbHZlLCByZWplY3QpID0+IHtcbiAgICBleGVjKGNvbW1hbmQsIHsgZW5jb2Rpbmc6ICd1dGY4JyB9LCAoZXJyb3IsIHN0ZG91dCwgc3RkZXJyKSA9PiB7XG4gICAgICBpZiAoZXJyb3IpIHtcbiAgICAgICAgY29uc29sZS5lcnJvcihgRXJyb3IgZXhlY3V0aW5nIGNvbW1hbmQ6ICR7Y29tbWFuZH1gKTtcbiAgICAgICAgY29uc29sZS5lcnJvcihgRXJyb3I6ICR7ZXJyb3J9YCk7XG4gICAgICAgIGNvbnNvbGUuZXJyb3IoYHN0ZGVycjogJHtzdGRlcnJ9YCk7XG4gICAgICAgIHJlamVjdChlcnJvcik7XG4gICAgICB9IGVsc2Uge1xuICAgICAgICByZXNvbHZlKHN0ZG91dCk7XG4gICAgICB9XG4gICAgfSk7XG4gIH0pO1xufVxuXG5leHBvcnQgYXN5bmMgZnVuY3Rpb24gcHJvY2Vzc1ZpZGVvKGZpbGVQYXRoOiBzdHJpbmcpIHtcbiAgdHJ5IHtcbiAgICAvLyAxLiDpn7PpopHliIbnprtcbiAgICBjb25zdCBhdWRpb0ZpbGUgPSBhd2FpdCBleHRyYWN0QXVkaW8oZmlsZVBhdGgpO1xuXG4gICAgLy8gMi4g6Z+z6aKR6L2s5paH5pysXG4gICAgY29uc3QgdGV4dENvbnRlbnQgPSBhd2FpdCBjb252ZXJ0U3BlZWNoVG9UZXh0KGF1ZGlvRmlsZSk7XG5cbiAgICAvLyAzLiDmlofmnKzmuIXmtJdcbiAgICBjb25zdCBjbGVhbmVkVGV4dCA9IGF3YWl0IGNsZWFuVGV4dCh0ZXh0Q29udGVudCk7XG5cbiAgICAvLyA0LiDmlofmnKzlrZjlgqhcbiAgICBhd2FpdCBzdG9yZVRleHQoW2NsZWFuZWRUZXh0XSk7XG5cbiAgICAvLyA1LiDpq5jnuqfliIbmnpBcbiAgICBjb25zdCBhbmFseXNpc1Jlc3VsdCA9IGF3YWl0IHBlcmZvcm1BZHZhbmNlZEFuYWx5c2lzKFtjbGVhbmVkVGV4dF0pO1xuXG4gICAgcmV0dXJuIGFuYWx5c2lzUmVzdWx0O1xuICB9IGNhdGNoIChlcnJvcikge1xuICAgIGNvbnNvbGUuZXJyb3IoJ0Vycm9yIGluIHZpZGVvIHByb2Nlc3Npbmc6JywgZXJyb3IpO1xuICAgIHRocm93IGVycm9yO1xuICB9XG59XG5cbmV4cG9ydCBmdW5jdGlvbiBleHRyYWN0QXVkaW8odmlkZW9QYXRoOiBzdHJpbmcpOiBQcm9taXNlPHN0cmluZz4ge1xuICByZXR1cm4gbmV3IFByb21pc2UoKHJlc29sdmUsIHJlamVjdCkgPT4ge1xuICAgIGNvbnN0IG91dHB1dERpciA9IHBhdGguam9pbihwcm9jZXNzLmN3ZCgpLCAncHVibGljJywgJ2F1ZGlvJyk7XG4gICAgaWYgKCFmcy5leGlzdHNTeW5jKG91dHB1dERpcikpIHtcbiAgICAgIGZzLm1rZGlyU3luYyhvdXRwdXREaXIsIHsgcmVjdXJzaXZlOiB0cnVlIH0pO1xuICAgIH1cbiAgICBjb25zdCBvdXRwdXRQYXRoID0gcGF0aC5qb2luKG91dHB1dERpciwgYCR7cGF0aC5iYXNlbmFtZSh2aWRlb1BhdGgsICcubXA0Jyl9Lm1wM2ApO1xuICAgIFxuICAgIGNvbnNvbGUubG9nKCdJbnB1dCB2aWRlbyBwYXRoOicsIHZpZGVvUGF0aCk7XG4gICAgY29uc29sZS5sb2coJ091dHB1dCBhdWRpbyBwYXRoOicsIG91dHB1dFBhdGgpO1xuXG4gICAgZmZtcGVnKHZpZGVvUGF0aClcbiAgICAgIC5vdXRwdXRPcHRpb25zKCctdm4nKVxuICAgICAgLmF1ZGlvQ29kZWMoJ2xpYm1wM2xhbWUnKVxuICAgICAgLmF1ZGlvQ2hhbm5lbHMoMilcbiAgICAgIC5hdWRpb0JpdHJhdGUoJzE5MmsnKVxuICAgICAgLm91dHB1dChvdXRwdXRQYXRoKVxuICAgICAgLm9uKCdlbmQnLCBhc3luYyAoKSA9PiB7XG4gICAgICAgIGNvbnNvbGUubG9nKCdBdWRpbyBleHRyYWN0aW9uIGNvbXBsZXRlZDonLCBvdXRwdXRQYXRoKTtcbiAgICAgICAgdHJ5IHtcbiAgICAgICAgICBjb25zdCB7IGRiIH0gPSBhd2FpdCBjb25uZWN0VG9EYXRhYmFzZSgpO1xuICAgICAgICAgIGNvbnN0IGNvbGxlY3Rpb24gPSBkYi5jb2xsZWN0aW9uKCdhdWRpb19maWxlcycpO1xuICAgICAgICAgIGNvbnN0IGR1cmF0aW9uID0gYXdhaXQgZ2V0QXVkaW9EdXJhdGlvbihvdXRwdXRQYXRoKTtcbiAgICAgICAgICBhd2FpdCBjb2xsZWN0aW9uLmluc2VydE9uZSh7XG4gICAgICAgICAgICBuYW1lOiBwYXRoLmJhc2VuYW1lKG91dHB1dFBhdGgpLFxuICAgICAgICAgICAgc2l6ZTogZnMuc3RhdFN5bmMob3V0cHV0UGF0aCkuc2l6ZSxcbiAgICAgICAgICAgIGNyZWF0ZWRBdDogbmV3IERhdGUoKSxcbiAgICAgICAgICAgIHBhdGg6IG91dHB1dFBhdGgsXG4gICAgICAgICAgICBvcmlnaW5hbFZpZGVvOiBwYXRoLmJhc2VuYW1lKHZpZGVvUGF0aCksXG4gICAgICAgICAgICBkdXJhdGlvbjogZHVyYXRpb24sXG4gICAgICAgICAgICB0cmFuc2NyaXB0aW9uU3RhdHVzOiAnbm90X3RyYW5zY3JpYmVkJ1xuICAgICAgICAgIH0pO1xuICAgICAgICAgIHJlc29sdmUob3V0cHV0UGF0aCk7XG4gICAgICAgIH0gY2F0Y2ggKGVycm9yKSB7XG4gICAgICAgICAgY29uc29sZS5lcnJvcignRXJyb3Igc2F2aW5nIGF1ZGlvIGZpbGUgaW5mbyB0byBkYXRhYmFzZTonLCBlcnJvcik7XG4gICAgICAgICAgcmVqZWN0KGVycm9yKTtcbiAgICAgICAgfVxuICAgICAgfSlcbiAgICAgIC5vbignZXJyb3InLCAoZXJyKSA9PiB7XG4gICAgICAgIGNvbnNvbGUuZXJyb3IoJ0Vycm9yIGR1cmluZyBhdWRpbyBleHRyYWN0aW9uOicsIGVycik7XG4gICAgICAgIHJlamVjdChlcnIpO1xuICAgICAgfSlcbiAgICAgIC5ydW4oKTtcbiAgfSk7XG59XG5cbmV4cG9ydCBhc3luYyBmdW5jdGlvbiBjb252ZXJ0U3BlZWNoVG9UZXh0KGF1ZGlvRmlsZTogc3RyaW5nKTogUHJvbWlzZTxzdHJpbmc+IHtcbiAgdHJ5IHtcbiAgICBjb25zdCBhdWRpb1BhdGggPSBwYXRoLmpvaW4ocHJvY2Vzcy5jd2QoKSwgJ3B1YmxpYycsICdhdWRpbycsIGF1ZGlvRmlsZSk7XG4gICAgaWYgKCFmcy5leGlzdHNTeW5jKGF1ZGlvUGF0aCkpIHtcbiAgICAgIHRocm93IG5ldyBFcnJvcihgQXVkaW8gZmlsZSBub3QgZm91bmQ6ICR7YXVkaW9QYXRofWApO1xuICAgIH1cblxuICAgIGNvbnN0IHJlc3BvbnNlID0gYXdhaXQgb3BlbmFpLmF1ZGlvLnRyYW5zY3JpcHRpb25zLmNyZWF0ZSh7XG4gICAgICBmaWxlOiBmcy5jcmVhdGVSZWFkU3RyZWFtKGF1ZGlvUGF0aCksXG4gICAgICBtb2RlbDogXCJ3aGlzcGVyLTFcIixcbiAgICB9KTtcbiAgICBcbiAgICBjb25zdCB0cmFuc2NyaXB0aW9uID0gcmVzcG9uc2UudGV4dDtcbiAgICBcbiAgICAvLyDkv53lrZjovazlvZXmlofmnKzkuLogdHh0IOaWh+S7tlxuICAgIGNvbnN0IHR4dEZpbGVQYXRoID0gYXVkaW9QYXRoLnJlcGxhY2UoJy5tcDMnLCAnLnR4dCcpO1xuICAgIGF3YWl0IGZzUHJvbWlzZXMud3JpdGVGaWxlKHR4dEZpbGVQYXRoLCB0cmFuc2NyaXB0aW9uLCAndXRmLTgnKTtcbiAgICBcbiAgICBjb25zb2xlLmxvZygnVHJhbnNjcmlwdGlvbiBzYXZlZCB0bzonLCB0eHRGaWxlUGF0aCk7XG4gICAgcmV0dXJuIHRyYW5zY3JpcHRpb247XG4gIH0gY2F0Y2ggKGVycm9yKSB7XG4gICAgY29uc29sZS5lcnJvcignRXJyb3IgaW4gc3BlZWNoIHRvIHRleHQgY29udmVyc2lvbjonLCBlcnJvcik7XG4gICAgdGhyb3cgZXJyb3I7XG4gIH1cbn1cblxuZXhwb3J0IGFzeW5jIGZ1bmN0aW9uIGNsZWFuVGV4dCh0ZXh0OiBzdHJpbmcpOiBQcm9taXNlPHN0cmluZz4ge1xuICAvLyDov5nph4zlj6/ku6Xlrp7njrDmlofmnKzmuIXmtJfnmoTpgLvovpFcbiAgLy8g5L6L5aaC77ya56e76Zmk54m55q6K5a2X56ym77yM57qg5q2j5bi46KeB6ZSZ6K+v562JXG4gIGxldCBjbGVhbmVkVGV4dCA9IHRleHQucmVwbGFjZSgvW15cXHdcXHMuLD8hXS9nLCAnJyk7XG4gIGNsZWFuZWRUZXh0ID0gY2xlYW5lZFRleHQucmVwbGFjZSgvXFxzKy9nLCAnICcpLnRyaW0oKTtcbiAgcmV0dXJuIGNsZWFuZWRUZXh0O1xufVxuXG5hc3luYyBmdW5jdGlvbiBzdG9yZVRleHQodGV4dHM6IHN0cmluZ1tdKTogUHJvbWlzZTx2b2lkPiB7XG4gIGNvbnN0IGNsaWVudCA9IGF3YWl0IGdldE1vbmdvQ2xpZW50KCk7XG4gIHRyeSB7XG4gICAgY29uc3QgZGIgPSBjbGllbnQuZGIoJ3ZpZGVvX2FuYWx5c2lzJyk7XG4gICAgY29uc3QgY29sbGVjdGlvbiA9IGRiLmNvbGxlY3Rpb24oJ3RyYW5zY3JpcHRzJyk7XG4gICAgYXdhaXQgY29sbGVjdGlvbi5pbnNlcnRNYW55KHRleHRzLm1hcCh0ZXh0ID0+ICh7IGNvbnRlbnQ6IHRleHQgfSkpKTtcbiAgICBjb25zb2xlLmxvZygnVGV4dHMgc3RvcmVkIHN1Y2Nlc3NmdWxseSBpbiBNb25nb0RCJyk7XG4gIH0gY2F0Y2ggKGVycm9yKSB7XG4gICAgY29uc29sZS5lcnJvcignRXJyb3Igc3RvcmluZyB0ZXh0cyBpbiBNb25nb0RCOicsIGVycm9yKTtcbiAgICB0aHJvdyBlcnJvcjtcbiAgfVxufVxuXG5hc3luYyBmdW5jdGlvbiBwZXJmb3JtQWR2YW5jZWRBbmFseXNpcyh0ZXh0czogc3RyaW5nW10pOiBQcm9taXNlPGFueT4ge1xuICByZXR1cm4geyBhbmFseXNpczogXCJTYW1wbGUgYW5hbHlzaXMgcmVzdWx0XCIgfTtcbn1cblxuZXhwb3J0IGFzeW5jIGZ1bmN0aW9uIGdldEF1ZGlvRHVyYXRpb24oZmlsZVBhdGg6IHN0cmluZyk6IFByb21pc2U8bnVtYmVyPiB7XG4gIHJldHVybiBuZXcgUHJvbWlzZSgocmVzb2x2ZSwgcmVqZWN0KSA9PiB7XG4gICAgZmZtcGVnLmZmcHJvYmUoZmlsZVBhdGgsIChlcnIsIG1ldGFkYXRhKSA9PiB7XG4gICAgICBpZiAoZXJyKSB7XG4gICAgICAgIHJlamVjdChlcnIpO1xuICAgICAgICByZXR1cm47XG4gICAgICB9XG4gICAgICBjb25zdCBkdXJhdGlvbkluU2Vjb25kcyA9IG1ldGFkYXRhLmZvcm1hdC5kdXJhdGlvbjtcbiAgICAgIHJlc29sdmUoZHVyYXRpb25JblNlY29uZHMpO1xuICAgIH0pO1xuICB9KTtcbn1cblxuZXhwb3J0IGFzeW5jIGZ1bmN0aW9uIGNoZWNrRkZtcGVnKCk6IFByb21pc2U8Ym9vbGVhbj4ge1xuICB0cnkge1xuICAgIGNvbnN0IGdldEF2YWlsYWJsZUZvcm1hdHMgPSBwcm9taXNpZnkoZmZtcGVnLmdldEF2YWlsYWJsZUZvcm1hdHMpO1xuICAgIGF3YWl0IGdldEF2YWlsYWJsZUZvcm1hdHMoKTtcbiAgICBjb25zb2xlLmxvZygnRkZtcGVnIGlzIGF2YWlsYWJsZScpO1xuICAgIHJldHVybiB0cnVlO1xuICB9IGNhdGNoIChlcnJvcikge1xuICAgIGNvbnNvbGUuZXJyb3IoJ0Vycm9yIGNoZWNraW5nIEZGbXBlZzonLCBlcnJvcik7XG4gICAgcmV0dXJuIGZhbHNlO1xuICB9XG59XG5cbmV4cG9ydCBhc3luYyBmdW5jdGlvbiBnZXRGRm1wZWdWZXJzaW9uKCk6IFByb21pc2U8c3RyaW5nPiB7XG4gIHRyeSB7XG4gICAgY29uc3QgZ2V0QXZhaWxhYmxlQ29kZWNzID0gcHJvbWlzaWZ5KGZmbXBlZy5nZXRBdmFpbGFibGVDb2RlY3MpO1xuICAgIGNvbnN0IGdldEF2YWlsYWJsZUVuY29kZXJzID0gcHJvbWlzaWZ5KGZmbXBlZy5nZXRBdmFpbGFibGVFbmNvZGVycyk7XG4gICAgXG4gICAgY29uc3QgY29kZWNzID0gYXdhaXQgZ2V0QXZhaWxhYmxlQ29kZWNzKCk7XG4gICAgY29uc3QgZW5jb2RlcnMgPSBhd2FpdCBnZXRBdmFpbGFibGVFbmNvZGVycygpO1xuICAgIFxuICAgIHJldHVybiBgRkZtcGVnIHZlcnNpb246IGF2YWlsYWJsZSAoY29kZWNzOiAke09iamVjdC5rZXlzKGNvZGVjcykubGVuZ3RofSwgZW5jb2RlcnM6ICR7T2JqZWN0LmtleXMoZW5jb2RlcnMpLmxlbmd0aH0pYDtcbiAgfSBjYXRjaCAoZXJyb3IpIHtcbiAgICBjb25zb2xlLmVycm9yKCdFcnJvciBnZXR0aW5nIEZGbXBlZyB2ZXJzaW9uOicsIGVycm9yKTtcbiAgICByZXR1cm4gJ0ZGbXBlZyB2ZXJzaW9uOiB1bmF2YWlsYWJsZSc7XG4gIH1cbn1cblxuZmZtcGVnLnNldEZmbXBlZ1BhdGgoZmZtcGVnSW5zdGFsbGVyLnBhdGgpO1xuZmZtcGVnLnNldEZmcHJvYmVQYXRoKGZmcHJvYmVJbnN0YWxsZXIucGF0aCk7XG5cbmV4cG9ydCBhc3luYyBmdW5jdGlvbiBnZXRBdWRpb0ZpbGVVcmwoZmlsZW5hbWU6IHN0cmluZyk6IFByb21pc2U8c3RyaW5nPiB7XG4gIC8vIOajgOafpeWkmuS4quWPr+iDveeahOi3r+W+hFxuICBjb25zdCBwb3NzaWJsZVBhdGhzID0gW1xuICAgIHBhdGguam9pbihwcm9jZXNzLmN3ZCgpLCAnZG93bmxvYWQnLCAnbXAzJywgZmlsZW5hbWUpLFxuICAgIHBhdGguam9pbihwcm9jZXNzLmN3ZCgpLCAncHVibGljJywgJ2F1ZGlvJywgZmlsZW5hbWUpLFxuICAgIHBhdGguam9pbihwcm9jZXNzLmN3ZCgpLCAncHVibGljJywgJ3VwbG9hZHMnLCBmaWxlbmFtZSlcbiAgXTtcblxuICBmb3IgKGNvbnN0IGZpbGVQYXRoIG9mIHBvc3NpYmxlUGF0aHMpIHtcbiAgICBjb25zb2xlLmxvZygnQ2hlY2tpbmcgZm9yIGF1ZGlvIGZpbGUgYXQ6JywgZmlsZVBhdGgpO1xuICAgIGlmIChmcy5leGlzdHNTeW5jKGZpbGVQYXRoKSkge1xuICAgICAgY29uc29sZS5sb2coJ0F1ZGlvIGZpbGUgZm91bmQgYXQ6JywgZmlsZVBhdGgpO1xuICAgICAgLy8g6L+U5Zue55u45a+55LqO5YWs5YWx55uu5b2V55qE6Lev5b6EXG4gICAgICByZXR1cm4gYC9hdWRpby8ke2VuY29kZVVSSUNvbXBvbmVudChmaWxlbmFtZSl9YDtcbiAgICB9XG4gIH1cblxuICBjb25zb2xlLmVycm9yKCdBdWRpbyBmaWxlIG5vdCBmb3VuZDonLCBmaWxlbmFtZSk7XG4gIGNvbnNvbGUuZXJyb3IoJ0NoZWNrZWQgcGF0aHM6JywgcG9zc2libGVQYXRocyk7XG4gIHRocm93IG5ldyBFcnJvcihgQXVkaW8gZmlsZSBub3QgZm91bmQ6ICR7ZmlsZW5hbWV9YCk7XG59XG4iXSwibmFtZXMiOlsiZXhlYyIsImZzIiwicGF0aCIsIk9wZW5BSSIsIk1vbmdvQ2xpZW50IiwiZmZtcGVnIiwiZmZtcGVnSW5zdGFsbGVyIiwiZmZwcm9iZUluc3RhbGxlciIsInByb21pc2lmeSIsInByb21pc2VzIiwiZnNQcm9taXNlcyIsImNvbm5lY3RUb0RhdGFiYXNlIiwib3BlbmFpIiwiYXBpS2V5IiwicHJvY2VzcyIsImVudiIsIk9QRU5BSV9BUElfS0VZIiwiYmFzZVVSTCIsIm1vbmdvVXJpIiwiTU9OR09EQl9VUkkiLCJjb25zb2xlIiwiZXJyb3IiLCJleGl0IiwibG9nIiwibW9uZ29DbGllbnQiLCJnZXRNb25nb0NsaWVudCIsIkVycm9yIiwiY29ubmVjdCIsInJ1bkNvbW1hbmQiLCJjb21tYW5kIiwiUHJvbWlzZSIsInJlc29sdmUiLCJyZWplY3QiLCJlbmNvZGluZyIsInN0ZG91dCIsInN0ZGVyciIsInByb2Nlc3NWaWRlbyIsImZpbGVQYXRoIiwiYXVkaW9GaWxlIiwiZXh0cmFjdEF1ZGlvIiwidGV4dENvbnRlbnQiLCJjb252ZXJ0U3BlZWNoVG9UZXh0IiwiY2xlYW5lZFRleHQiLCJjbGVhblRleHQiLCJzdG9yZVRleHQiLCJhbmFseXNpc1Jlc3VsdCIsInBlcmZvcm1BZHZhbmNlZEFuYWx5c2lzIiwidmlkZW9QYXRoIiwib3V0cHV0RGlyIiwiam9pbiIsImN3ZCIsImV4aXN0c1N5bmMiLCJta2RpclN5bmMiLCJyZWN1cnNpdmUiLCJvdXRwdXRQYXRoIiwiYmFzZW5hbWUiLCJvdXRwdXRPcHRpb25zIiwiYXVkaW9Db2RlYyIsImF1ZGlvQ2hhbm5lbHMiLCJhdWRpb0JpdHJhdGUiLCJvdXRwdXQiLCJvbiIsImRiIiwiY29sbGVjdGlvbiIsImR1cmF0aW9uIiwiZ2V0QXVkaW9EdXJhdGlvbiIsImluc2VydE9uZSIsIm5hbWUiLCJzaXplIiwic3RhdFN5bmMiLCJjcmVhdGVkQXQiLCJEYXRlIiwib3JpZ2luYWxWaWRlbyIsInRyYW5zY3JpcHRpb25TdGF0dXMiLCJlcnIiLCJydW4iLCJhdWRpb1BhdGgiLCJyZXNwb25zZSIsImF1ZGlvIiwidHJhbnNjcmlwdGlvbnMiLCJjcmVhdGUiLCJmaWxlIiwiY3JlYXRlUmVhZFN0cmVhbSIsIm1vZGVsIiwidHJhbnNjcmlwdGlvbiIsInRleHQiLCJ0eHRGaWxlUGF0aCIsInJlcGxhY2UiLCJ3cml0ZUZpbGUiLCJ0cmltIiwidGV4dHMiLCJjbGllbnQiLCJpbnNlcnRNYW55IiwibWFwIiwiY29udGVudCIsImFuYWx5c2lzIiwiZmZwcm9iZSIsIm1ldGFkYXRhIiwiZHVyYXRpb25JblNlY29uZHMiLCJmb3JtYXQiLCJjaGVja0ZGbXBlZyIsImdldEF2YWlsYWJsZUZvcm1hdHMiLCJnZXRGRm1wZWdWZXJzaW9uIiwiZ2V0QXZhaWxhYmxlQ29kZWNzIiwiZ2V0QXZhaWxhYmxlRW5jb2RlcnMiLCJjb2RlY3MiLCJlbmNvZGVycyIsIk9iamVjdCIsImtleXMiLCJsZW5ndGgiLCJzZXRGZm1wZWdQYXRoIiwic2V0RmZwcm9iZVBhdGgiLCJnZXRBdWRpb0ZpbGVVcmwiLCJmaWxlbmFtZSIsInBvc3NpYmxlUGF0aHMiLCJlbmNvZGVVUklDb21wb25lbnQiXSwic291cmNlUm9vdCI6IiJ9\n//# sourceURL=webpack-internal:///(api)/./utils/videoProcessor.ts\n");

/***/ })

};
;

// load runtime
var __webpack_require__ = require("../../webpack-api-runtime.js");
__webpack_require__.C(exports);
var __webpack_exec__ = (moduleId) => (__webpack_require__(__webpack_require__.s = moduleId))
var __webpack_exports__ = (__webpack_exec__("(api)/./pages/api/transcribe.ts"));
module.exports = __webpack_exports__;

})();