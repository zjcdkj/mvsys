"use strict";
/*
 * ATTENTION: An "eval-source-map" devtool has been used.
 * This devtool is neither made for production nor for readable output files.
 * It uses "eval()" calls to create a separate source file with attached SourceMaps in the browser devtools.
 * If you are trying to read the output file, select a different devtool (https://webpack.js.org/configuration/devtool/)
 * or disable the default devtool with "devtool: false".
 * If you are looking for production-ready output files, see mode: "production" (https://webpack.js.org/configuration/mode/).
 */
(() => {
var exports = {};
exports.id = "pages/api/audio/list";
exports.ids = ["pages/api/audio/list"];
exports.modules = {

/***/ "mongodb":
/*!**************************!*\
  !*** external "mongodb" ***!
  \**************************/
/***/ ((module) => {

module.exports = require("mongodb");

/***/ }),

/***/ "(api)/./pages/api/audio/list.ts":
/*!*********************************!*\
  !*** ./pages/api/audio/list.ts ***!
  \*********************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   \"default\": () => (/* binding */ handler)\n/* harmony export */ });\n/* harmony import */ var _utils_database__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../../../utils/database */ \"(api)/./utils/database.ts\");\n\nasync function handler(req, res) {\n    if (req.method === \"GET\") {\n        try {\n            console.log(\"Connecting to database...\");\n            const { db } = await (0,_utils_database__WEBPACK_IMPORTED_MODULE_0__.connectToDatabase)();\n            console.log(\"Connected to database\");\n            console.log(\"Fetching audio files...\");\n            const audioCollection = db.collection(\"audio_files\");\n            const audioFiles = await audioCollection.find({}).toArray();\n            console.log(`Fetched ${audioFiles.length} audio files`);\n            // 使用 Set 来去除可能的重复项\n            const uniqueAudioFiles = Array.from(new Set(audioFiles.map((file)=>file.name))).map((name)=>{\n                const file = audioFiles.find((f)=>f.name === name);\n                return {\n                    ...file,\n                    _id: file._id.toString() // 将 ObjectId 转换为字符串\n                };\n            });\n            console.log(`Returning ${uniqueAudioFiles.length} unique audio files`);\n            res.status(200).json(uniqueAudioFiles);\n        } catch (error) {\n            console.error(\"Error in audio/list API:\", error);\n            res.status(500).json({\n                error: \"Internal Server Error\",\n                details: error.message\n            });\n        }\n    } else {\n        res.setHeader(\"Allow\", [\n            \"GET\"\n        ]);\n        res.status(405).end(`Method ${req.method} Not Allowed`);\n    }\n}\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKGFwaSkvLi9wYWdlcy9hcGkvYXVkaW8vbGlzdC50cyIsIm1hcHBpbmdzIjoiOzs7OztBQUM0RDtBQUU3QyxlQUFlQyxRQUFRQyxHQUFtQixFQUFFQyxHQUFvQjtJQUM3RSxJQUFJRCxJQUFJRSxNQUFNLEtBQUssT0FBTztRQUN4QixJQUFJO1lBQ0ZDLFFBQVFDLEdBQUcsQ0FBQztZQUNaLE1BQU0sRUFBRUMsRUFBRSxFQUFFLEdBQUcsTUFBTVAsa0VBQWlCQTtZQUN0Q0ssUUFBUUMsR0FBRyxDQUFDO1lBRVpELFFBQVFDLEdBQUcsQ0FBQztZQUNaLE1BQU1FLGtCQUFrQkQsR0FBR0UsVUFBVSxDQUFDO1lBQ3RDLE1BQU1DLGFBQWEsTUFBTUYsZ0JBQWdCRyxJQUFJLENBQUMsQ0FBQyxHQUFHQyxPQUFPO1lBQ3pEUCxRQUFRQyxHQUFHLENBQUMsQ0FBQyxRQUFRLEVBQUVJLFdBQVdHLE1BQU0sQ0FBQyxZQUFZLENBQUM7WUFFdEQsbUJBQW1CO1lBQ25CLE1BQU1DLG1CQUFtQkMsTUFBTUMsSUFBSSxDQUFDLElBQUlDLElBQUlQLFdBQVdRLEdBQUcsQ0FBQ0MsQ0FBQUEsT0FBUUEsS0FBS0MsSUFBSSxJQUN6RUYsR0FBRyxDQUFDRSxDQUFBQTtnQkFDSCxNQUFNRCxPQUFPVCxXQUFXQyxJQUFJLENBQUNVLENBQUFBLElBQUtBLEVBQUVELElBQUksS0FBS0E7Z0JBQzdDLE9BQU87b0JBQ0wsR0FBR0QsSUFBSTtvQkFDUEcsS0FBS0gsS0FBS0csR0FBRyxDQUFDQyxRQUFRLEdBQUcsb0JBQW9CO2dCQUMvQztZQUNGO1lBRUZsQixRQUFRQyxHQUFHLENBQUMsQ0FBQyxVQUFVLEVBQUVRLGlCQUFpQkQsTUFBTSxDQUFDLG1CQUFtQixDQUFDO1lBQ3JFVixJQUFJcUIsTUFBTSxDQUFDLEtBQUtDLElBQUksQ0FBQ1g7UUFDdkIsRUFBRSxPQUFPWSxPQUFPO1lBQ2RyQixRQUFRcUIsS0FBSyxDQUFDLDRCQUE0QkE7WUFDMUN2QixJQUFJcUIsTUFBTSxDQUFDLEtBQUtDLElBQUksQ0FBQztnQkFBRUMsT0FBTztnQkFBeUJDLFNBQVNELE1BQU1FLE9BQU87WUFBQztRQUNoRjtJQUNGLE9BQU87UUFDTHpCLElBQUkwQixTQUFTLENBQUMsU0FBUztZQUFDO1NBQU07UUFDOUIxQixJQUFJcUIsTUFBTSxDQUFDLEtBQUtNLEdBQUcsQ0FBQyxDQUFDLE9BQU8sRUFBRTVCLElBQUlFLE1BQU0sQ0FBQyxZQUFZLENBQUM7SUFDeEQ7QUFDRiIsInNvdXJjZXMiOlsid2VicGFjazovL3ZpZGVvLWFuYWx5c2lzLXN5c3RlbS8uL3BhZ2VzL2FwaS9hdWRpby9saXN0LnRzPzcyZGYiXSwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IHsgTmV4dEFwaVJlcXVlc3QsIE5leHRBcGlSZXNwb25zZSB9IGZyb20gJ25leHQnO1xuaW1wb3J0IHsgY29ubmVjdFRvRGF0YWJhc2UgfSBmcm9tICcuLi8uLi8uLi91dGlscy9kYXRhYmFzZSc7XG5cbmV4cG9ydCBkZWZhdWx0IGFzeW5jIGZ1bmN0aW9uIGhhbmRsZXIocmVxOiBOZXh0QXBpUmVxdWVzdCwgcmVzOiBOZXh0QXBpUmVzcG9uc2UpIHtcbiAgaWYgKHJlcS5tZXRob2QgPT09ICdHRVQnKSB7XG4gICAgdHJ5IHtcbiAgICAgIGNvbnNvbGUubG9nKCdDb25uZWN0aW5nIHRvIGRhdGFiYXNlLi4uJyk7XG4gICAgICBjb25zdCB7IGRiIH0gPSBhd2FpdCBjb25uZWN0VG9EYXRhYmFzZSgpO1xuICAgICAgY29uc29sZS5sb2coJ0Nvbm5lY3RlZCB0byBkYXRhYmFzZScpO1xuXG4gICAgICBjb25zb2xlLmxvZygnRmV0Y2hpbmcgYXVkaW8gZmlsZXMuLi4nKTtcbiAgICAgIGNvbnN0IGF1ZGlvQ29sbGVjdGlvbiA9IGRiLmNvbGxlY3Rpb24oJ2F1ZGlvX2ZpbGVzJyk7XG4gICAgICBjb25zdCBhdWRpb0ZpbGVzID0gYXdhaXQgYXVkaW9Db2xsZWN0aW9uLmZpbmQoe30pLnRvQXJyYXkoKTtcbiAgICAgIGNvbnNvbGUubG9nKGBGZXRjaGVkICR7YXVkaW9GaWxlcy5sZW5ndGh9IGF1ZGlvIGZpbGVzYCk7XG5cbiAgICAgIC8vIOS9v+eUqCBTZXQg5p2l5Y676Zmk5Y+v6IO955qE6YeN5aSN6aG5XG4gICAgICBjb25zdCB1bmlxdWVBdWRpb0ZpbGVzID0gQXJyYXkuZnJvbShuZXcgU2V0KGF1ZGlvRmlsZXMubWFwKGZpbGUgPT4gZmlsZS5uYW1lKSkpXG4gICAgICAgIC5tYXAobmFtZSA9PiB7XG4gICAgICAgICAgY29uc3QgZmlsZSA9IGF1ZGlvRmlsZXMuZmluZChmID0+IGYubmFtZSA9PT0gbmFtZSk7XG4gICAgICAgICAgcmV0dXJuIHtcbiAgICAgICAgICAgIC4uLmZpbGUsXG4gICAgICAgICAgICBfaWQ6IGZpbGUuX2lkLnRvU3RyaW5nKCkgLy8g5bCGIE9iamVjdElkIOi9rOaNouS4uuWtl+espuS4slxuICAgICAgICAgIH07XG4gICAgICAgIH0pO1xuXG4gICAgICBjb25zb2xlLmxvZyhgUmV0dXJuaW5nICR7dW5pcXVlQXVkaW9GaWxlcy5sZW5ndGh9IHVuaXF1ZSBhdWRpbyBmaWxlc2ApO1xuICAgICAgcmVzLnN0YXR1cygyMDApLmpzb24odW5pcXVlQXVkaW9GaWxlcyk7XG4gICAgfSBjYXRjaCAoZXJyb3IpIHtcbiAgICAgIGNvbnNvbGUuZXJyb3IoJ0Vycm9yIGluIGF1ZGlvL2xpc3QgQVBJOicsIGVycm9yKTtcbiAgICAgIHJlcy5zdGF0dXMoNTAwKS5qc29uKHsgZXJyb3I6ICdJbnRlcm5hbCBTZXJ2ZXIgRXJyb3InLCBkZXRhaWxzOiBlcnJvci5tZXNzYWdlIH0pO1xuICAgIH1cbiAgfSBlbHNlIHtcbiAgICByZXMuc2V0SGVhZGVyKCdBbGxvdycsIFsnR0VUJ10pO1xuICAgIHJlcy5zdGF0dXMoNDA1KS5lbmQoYE1ldGhvZCAke3JlcS5tZXRob2R9IE5vdCBBbGxvd2VkYCk7XG4gIH1cbn1cbiJdLCJuYW1lcyI6WyJjb25uZWN0VG9EYXRhYmFzZSIsImhhbmRsZXIiLCJyZXEiLCJyZXMiLCJtZXRob2QiLCJjb25zb2xlIiwibG9nIiwiZGIiLCJhdWRpb0NvbGxlY3Rpb24iLCJjb2xsZWN0aW9uIiwiYXVkaW9GaWxlcyIsImZpbmQiLCJ0b0FycmF5IiwibGVuZ3RoIiwidW5pcXVlQXVkaW9GaWxlcyIsIkFycmF5IiwiZnJvbSIsIlNldCIsIm1hcCIsImZpbGUiLCJuYW1lIiwiZiIsIl9pZCIsInRvU3RyaW5nIiwic3RhdHVzIiwianNvbiIsImVycm9yIiwiZGV0YWlscyIsIm1lc3NhZ2UiLCJzZXRIZWFkZXIiLCJlbmQiXSwic291cmNlUm9vdCI6IiJ9\n//# sourceURL=webpack-internal:///(api)/./pages/api/audio/list.ts\n");

/***/ }),

/***/ "(api)/./utils/database.ts":
/*!***************************!*\
  !*** ./utils/database.ts ***!
  \***************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   connectToDatabase: () => (/* binding */ connectToDatabase)\n/* harmony export */ });\n/* harmony import */ var mongodb__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! mongodb */ \"mongodb\");\n/* harmony import */ var mongodb__WEBPACK_IMPORTED_MODULE_0___default = /*#__PURE__*/__webpack_require__.n(mongodb__WEBPACK_IMPORTED_MODULE_0__);\n\nconst MONGODB_URI = process.env.MONGODB_URI;\nif (!MONGODB_URI) {\n    throw new Error(\"Please define the MONGODB_URI environment variable inside .env.local\");\n}\nlet cached = global;\nif (!cached.mongo) {\n    cached.mongo = {\n        conn: null,\n        promise: null\n    };\n}\nasync function connectToDatabase() {\n    if (cached.mongo.conn) {\n        return cached.mongo.conn;\n    }\n    if (!cached.mongo.promise) {\n        const opts = {\n            useNewUrlParser: true,\n            useUnifiedTopology: true\n        };\n        cached.mongo.promise = mongodb__WEBPACK_IMPORTED_MODULE_0__.MongoClient.connect(MONGODB_URI, opts).then((client)=>{\n            console.log(\"New database connection established\");\n            return {\n                client,\n                db: client.db()\n            };\n        }).catch((error)=>{\n            console.error(\"Failed to connect to database:\", error);\n            throw error;\n        });\n    }\n    try {\n        cached.mongo.conn = await cached.mongo.promise;\n    } catch (e) {\n        cached.mongo.promise = null;\n        throw e;\n    }\n    return cached.mongo.conn;\n}\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKGFwaSkvLi91dGlscy9kYXRhYmFzZS50cyIsIm1hcHBpbmdzIjoiOzs7Ozs7QUFBc0M7QUFFdEMsTUFBTUMsY0FBY0MsUUFBUUMsR0FBRyxDQUFDRixXQUFXO0FBRTNDLElBQUksQ0FBQ0EsYUFBYTtJQUNoQixNQUFNLElBQUlHLE1BQU07QUFDbEI7QUFFQSxJQUFJQyxTQUFTQztBQUViLElBQUksQ0FBQ0QsT0FBT0UsS0FBSyxFQUFFO0lBQ2pCRixPQUFPRSxLQUFLLEdBQUc7UUFBRUMsTUFBTTtRQUFNQyxTQUFTO0lBQUs7QUFDN0M7QUFFTyxlQUFlQztJQUNwQixJQUFJTCxPQUFPRSxLQUFLLENBQUNDLElBQUksRUFBRTtRQUNyQixPQUFPSCxPQUFPRSxLQUFLLENBQUNDLElBQUk7SUFDMUI7SUFFQSxJQUFJLENBQUNILE9BQU9FLEtBQUssQ0FBQ0UsT0FBTyxFQUFFO1FBQ3pCLE1BQU1FLE9BQU87WUFDWEMsaUJBQWlCO1lBQ2pCQyxvQkFBb0I7UUFDdEI7UUFFQVIsT0FBT0UsS0FBSyxDQUFDRSxPQUFPLEdBQUdULGdEQUFXQSxDQUFDYyxPQUFPLENBQUNiLGFBQWNVLE1BQU1JLElBQUksQ0FBQyxDQUFDQztZQUNuRUMsUUFBUUMsR0FBRyxDQUFDO1lBQ1osT0FBTztnQkFDTEY7Z0JBQ0FHLElBQUlILE9BQU9HLEVBQUU7WUFDZjtRQUNGLEdBQUdDLEtBQUssQ0FBQyxDQUFDQztZQUNSSixRQUFRSSxLQUFLLENBQUMsa0NBQWtDQTtZQUNoRCxNQUFNQTtRQUNSO0lBQ0Y7SUFFQSxJQUFJO1FBQ0ZoQixPQUFPRSxLQUFLLENBQUNDLElBQUksR0FBRyxNQUFNSCxPQUFPRSxLQUFLLENBQUNFLE9BQU87SUFDaEQsRUFBRSxPQUFPYSxHQUFHO1FBQ1ZqQixPQUFPRSxLQUFLLENBQUNFLE9BQU8sR0FBRztRQUN2QixNQUFNYTtJQUNSO0lBRUEsT0FBT2pCLE9BQU9FLEtBQUssQ0FBQ0MsSUFBSTtBQUMxQiIsInNvdXJjZXMiOlsid2VicGFjazovL3ZpZGVvLWFuYWx5c2lzLXN5c3RlbS8uL3V0aWxzL2RhdGFiYXNlLnRzPzZhZjkiXSwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IHsgTW9uZ29DbGllbnQgfSBmcm9tICdtb25nb2RiJztcblxuY29uc3QgTU9OR09EQl9VUkkgPSBwcm9jZXNzLmVudi5NT05HT0RCX1VSSTtcblxuaWYgKCFNT05HT0RCX1VSSSkge1xuICB0aHJvdyBuZXcgRXJyb3IoJ1BsZWFzZSBkZWZpbmUgdGhlIE1PTkdPREJfVVJJIGVudmlyb25tZW50IHZhcmlhYmxlIGluc2lkZSAuZW52LmxvY2FsJyk7XG59XG5cbmxldCBjYWNoZWQgPSBnbG9iYWwgYXMgYW55O1xuXG5pZiAoIWNhY2hlZC5tb25nbykge1xuICBjYWNoZWQubW9uZ28gPSB7IGNvbm46IG51bGwsIHByb21pc2U6IG51bGwgfTtcbn1cblxuZXhwb3J0IGFzeW5jIGZ1bmN0aW9uIGNvbm5lY3RUb0RhdGFiYXNlKCkge1xuICBpZiAoY2FjaGVkLm1vbmdvLmNvbm4pIHtcbiAgICByZXR1cm4gY2FjaGVkLm1vbmdvLmNvbm47XG4gIH1cblxuICBpZiAoIWNhY2hlZC5tb25nby5wcm9taXNlKSB7XG4gICAgY29uc3Qgb3B0cyA9IHtcbiAgICAgIHVzZU5ld1VybFBhcnNlcjogdHJ1ZSxcbiAgICAgIHVzZVVuaWZpZWRUb3BvbG9neTogdHJ1ZSxcbiAgICB9O1xuXG4gICAgY2FjaGVkLm1vbmdvLnByb21pc2UgPSBNb25nb0NsaWVudC5jb25uZWN0KE1PTkdPREJfVVJJISwgb3B0cykudGhlbigoY2xpZW50KSA9PiB7XG4gICAgICBjb25zb2xlLmxvZygnTmV3IGRhdGFiYXNlIGNvbm5lY3Rpb24gZXN0YWJsaXNoZWQnKTtcbiAgICAgIHJldHVybiB7XG4gICAgICAgIGNsaWVudCxcbiAgICAgICAgZGI6IGNsaWVudC5kYigpLFxuICAgICAgfTtcbiAgICB9KS5jYXRjaCgoZXJyb3IpID0+IHtcbiAgICAgIGNvbnNvbGUuZXJyb3IoJ0ZhaWxlZCB0byBjb25uZWN0IHRvIGRhdGFiYXNlOicsIGVycm9yKTtcbiAgICAgIHRocm93IGVycm9yO1xuICAgIH0pO1xuICB9XG5cbiAgdHJ5IHtcbiAgICBjYWNoZWQubW9uZ28uY29ubiA9IGF3YWl0IGNhY2hlZC5tb25nby5wcm9taXNlO1xuICB9IGNhdGNoIChlKSB7XG4gICAgY2FjaGVkLm1vbmdvLnByb21pc2UgPSBudWxsO1xuICAgIHRocm93IGU7XG4gIH1cblxuICByZXR1cm4gY2FjaGVkLm1vbmdvLmNvbm47XG59XG4iXSwibmFtZXMiOlsiTW9uZ29DbGllbnQiLCJNT05HT0RCX1VSSSIsInByb2Nlc3MiLCJlbnYiLCJFcnJvciIsImNhY2hlZCIsImdsb2JhbCIsIm1vbmdvIiwiY29ubiIsInByb21pc2UiLCJjb25uZWN0VG9EYXRhYmFzZSIsIm9wdHMiLCJ1c2VOZXdVcmxQYXJzZXIiLCJ1c2VVbmlmaWVkVG9wb2xvZ3kiLCJjb25uZWN0IiwidGhlbiIsImNsaWVudCIsImNvbnNvbGUiLCJsb2ciLCJkYiIsImNhdGNoIiwiZXJyb3IiLCJlIl0sInNvdXJjZVJvb3QiOiIifQ==\n//# sourceURL=webpack-internal:///(api)/./utils/database.ts\n");

/***/ })

};
;

// load runtime
var __webpack_require__ = require("../../../webpack-api-runtime.js");
__webpack_require__.C(exports);
var __webpack_exec__ = (moduleId) => (__webpack_require__(__webpack_require__.s = moduleId))
var __webpack_exports__ = (__webpack_exec__("(api)/./pages/api/audio/list.ts"));
module.exports = __webpack_exports__;

})();